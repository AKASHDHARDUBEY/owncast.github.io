{"version":3,"file":"static/chunks/7177.d6842813d5ab1fbc.js","mappings":"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","sources":["webpack://_N_E/./components/modals/FollowModal/FollowModal.tsx","webpack://_N_E/./components/modals/FollowModal/FollowModal.module.scss","webpack://_N_E/<anon>"],"sourcesContent":["/* eslint-disable react/no-unescaped-entities */\nimport { Input, Button, Alert, Spin, Space } from 'antd';\nimport { FC, useState } from 'react';\nimport styles from './FollowModal.module.scss';\n\nconst ENDPOINT = '/api/remotefollow';\n\nexport type FollowModalProps = {\n  handleClose: () => void;\n  account: string;\n  name: string;\n};\n\nfunction validateAccount(a) {\n  const sanitized = a.replace(/^@+/, '');\n  const regex =\n    /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n  return regex.test(String(sanitized).toLowerCase());\n}\n\nexport const FollowModal: FC<FollowModalProps> = ({ handleClose, account, name }) => {\n  const [remoteAccount, setRemoteAccount] = useState(null);\n  const [valid, setValid] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(null);\n\n  const handleAccountChange = a => {\n    setRemoteAccount(a);\n    if (validateAccount(a)) {\n      setValid(true);\n    } else {\n      setValid(false);\n    }\n  };\n\n  const joinButtonPressed = () => {\n    window.open('https://owncast.online/join-fediverse', '_blank');\n  };\n\n  const remoteFollowButtonPressed = async () => {\n    if (!valid) {\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const sanitizedAccount = remoteAccount.replace(/^@+/, '');\n      const request = { account: sanitizedAccount };\n      const rawResponse = await fetch(ENDPOINT, {\n        method: 'POST',\n        body: JSON.stringify(request),\n      });\n      const result = await rawResponse.json();\n\n      if (result.redirectUrl) {\n        window.open(result.redirectUrl, '_blank');\n        handleClose();\n      }\n      if (!result.success) {\n        setErrorMessage(result.message);\n        setLoading(false);\n        return;\n      }\n      if (!result.redirectUrl) {\n        setErrorMessage('Unable to follow.');\n        setLoading(false);\n        return;\n      }\n    } catch (e) {\n      setErrorMessage(e.message);\n    }\n    setLoading(false);\n  };\n\n  return (\n    <Space direction=\"vertical\" id=\"follow-modal\">\n      <div className={styles.header}>\n        By following this stream you'll get notified on the Fediverse when it goes live. Now is a\n        great time to\n        <a href=\"https://owncast.online/join-fediverse\" target=\"_blank\" rel=\"noreferrer\">\n          &nbsp;learn about the Fediverse&nbsp;\n        </a>\n        if it's new to you.\n      </div>\n\n      <Spin spinning={loading}>\n        {errorMessage && (\n          <Alert message=\"Follow Error\" description={errorMessage} type=\"error\" showIcon />\n        )}\n        <div className={styles.account}>\n          <img src=\"/logo\" alt=\"logo\" className={styles.logo} />\n          <div className={styles.username}>\n            <div className={styles.name}>{name}</div>\n            <div>{account}</div>\n          </div>\n        </div>\n\n        <div>\n          <div className={styles.instructions}>Enter your username @server to follow</div>\n          <Input\n            value={remoteAccount}\n            size=\"large\"\n            onChange={e => handleAccountChange(e.target.value)}\n            placeholder=\"Your fediverse account @account@server\"\n            defaultValue={remoteAccount}\n          />\n          <div className={styles.footer}>\n            You'll be redirected to your Fediverse server and asked to confirm the action.\n          </div>\n        </div>\n        <Space className={styles.buttons}>\n          <Button disabled={!valid} type=\"primary\" onClick={remoteFollowButtonPressed}>\n            Follow\n          </Button>\n          <Button onClick={joinButtonPressed} type=\"primary\">\n            Join the Fediverse\n          </Button>\n        </Space>\n      </Spin>\n    </Space>\n  );\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"FollowModal_header__la1ji\",\"buttons\":\"FollowModal_buttons__tt4Mc\",\"instructions\":\"FollowModal_instructions__HiKFF\",\"footer\":\"FollowModal_footer__AjucH\",\"account\":\"FollowModal_account__cmHkm\",\"logo\":\"FollowModal_logo__Ew8xK\",\"username\":\"FollowModal_username__A_OTw\",\"name\":\"FollowModal_name__Sf_TP\"};"],"names":["FollowModal","handleClose","account","name","param","remoteAccount","setRemoteAccount","useState","valid","setValid","loading","setLoading","errorMessage","setErrorMessage","handleAccountChange","a","validateAccount","sanitized","replace","regex","test","String","toLowerCase","joinButtonPressed","window","open","remoteFollowButtonPressed","sanitizedAccount","rawResponse","fetch","method","body","JSON","stringify","result","json","redirectUrl","success","message","e","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__","jsxs","Space","direction","id","div","className","styles","jsx","href","target","rel","Spin","spinning","Alert","description","type","showIcon","img","src","alt","Input","value","size","onChange","placeholder","defaultValue","Button","disabled","onClick","module","exports"],"sourceRoot":""}