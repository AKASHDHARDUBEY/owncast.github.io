<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Owncast with S3 Providers #  Instead of serving video directly from your personal server you can use a S3 compatible storage provider to offload the bandwidth and storage requirements elsewhere.
Choose your storage provider of choice. Yours not listed? File an issue and we&rsquo;ll test and write up some documentation for it.
 Linode Object Storage AWS S3 Wasabi  Linode Object Storage #  250 GB storage + 1 TB Outbound Transfer for $5/mo."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content><meta property="og:description" content="Owncast with S3 Providers #  Instead of serving video directly from your personal server you can use a S3 compatible storage provider to offload the bandwidth and storage requirements elsewhere.
Choose your storage provider of choice. Yours not listed? File an issue and we&rsquo;ll test and write up some documentation for it.
 Linode Object Storage AWS S3 Wasabi  Linode Object Storage #  250 GB storage + 1 TB Outbound Transfer for $5/mo."><meta property="og:type" content="article"><meta property="og:url" content="http://owncast.online/docs/s3/"><meta property="og:image" content="http://owncast.online/images/logo.png"><meta property="article:modified_time" content="2020-08-21T09:42:51-07:00"><meta property="og:site_name" content="Owncast"><title>S3 | Owncast</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.e540a23134a8dcb7930f58d1ba62a11848b487d2a913ad0c1471d1c7eee702da.css integrity="sha256-5UCiMTSo3LeTD1jRumKhGEi0h9KpE60MFHHRx+7nAto="><script defer src=/en.search.min.8f3d1d6b1c7617222cbbbd503b2a46e576ea36f10001bfcc08df94ba177bcc93.js integrity="sha256-jz0daxx2FyIsu71QOypG5XbqNvEAAb/MCN+Uuhd7zJM="></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><img src=/favicon.png alt=Logo><span>Owncast</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/>Docs</a><ul><li><a href=/docs/quickstart/>Quickstart</a></li><li><a href=/docs/configuration/>Configuration</a></li><li><a href=/docs/website/>Web Site + Chat</a></li><li><a href=/docs/broadcasting/>Broadcasting Software</a></li><li><a href=/docs/encoding/>Encoding</a></li><li><a href=/docs/s3/ class=active>External Storage (S3)</a></li><li><a href=/docs/building/>Building from Source</a></li></ul></li><li><a href=/docs/faq/>F.A.Q.</a></li><li><a href=/usecases/>Use Cases</a></li><li><a href=/posts/>Blog</a></li><li><a href=/contribute>Contribute</a></li><li><a href=/contact>Contact</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>S3</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#linode-object-storagehttpswwwlinodecompricingr588ad4bf08ce8394e8eb11f0a463fde64637af9drow--storage><a href="https://www.linode.com/pricing/?r=588ad4bf08ce8394e8eb11f0a463fde64637af9d/#row--storage">Linode Object Storage</a></a><ul><li><a href=#add-permissions-to-access-video>Add permissions to access video.</a></li><li><a href=#file-expiration>File expiration</a></li></ul></li><li><a href=#aws-s3>AWS S3</a><ul><li><a href=#file-expiration-1>File expiration</a></li><li><a href=#cors>CORS</a></li><li><a href=#cdn>CDN</a></li></ul></li><li><a href=#wasabi-cloud-storage>Wasabi cloud storage</a><ul><li><a href=#create-a-user-and-access-key>Create a user and access key.</a></li><li><a href=#making-files-public>Making files public</a></li><li><a href=#expiration-of-old-files-on-wasabi>Expiration of old files on Wasabi</a></li></ul></li><li><a href=#digital-ocean-spaces>Digital Ocean Spaces</a></li></ul></nav></aside></header><article class=markdown><h1 id=owncast-with-s3-providers>Owncast with S3 Providers
<a class=anchor href=#owncast-with-s3-providers>#</a></h1><p>Instead of serving video directly from your personal server you can use a S3 compatible storage provider to offload the bandwidth and storage requirements elsewhere.</p><p>Choose your storage provider of choice. Yours not listed? <a href=https://github.com/gabek/owncast/issues>File an issue</a> and we&rsquo;ll test and write up some documentation for it.</p><ul><li><a href=#linode-object-storage>Linode Object Storage</a></li><li><a href=#aws-s3>AWS S3</a></li><li><a href=#wasabi-cloud-storage>Wasabi</a></li></ul><h2 id=linode-object-storagehttpswwwlinodecompricingr588ad4bf08ce8394e8eb11f0a463fde64637af9drow--storage><a href="https://www.linode.com/pricing/?r=588ad4bf08ce8394e8eb11f0a463fde64637af9d/#row--storage">Linode Object Storage</a>
<a class=anchor href=#linode-object-storagehttpswwwlinodecompricingr588ad4bf08ce8394e8eb11f0a463fde64637af9drow--storage>#</a></h2><p>250 GB storage + 1 TB Outbound Transfer for $5/mo.</p><p>Linode Object Storage is a good choice if you&rsquo;re already using Linode to host your server. It should be fast to transfer your video from your server to their storage service, and their pricing will probably just be the flat $5/mo for you, so it&rsquo;s easy to know what you&rsquo;re paying.<div style=text-align:center><figure><img src=/docs/img/linodebucket.png></figure></div></p><ul><li>Create a new bucket at the <a href=https://cloud.linode.com/object-storage/buckets>Linode Object Storage</a> admin page.</li><li>Edit your config file and change the S3 <code>endpoint</code> to match the hostname listed below your newly created bucket that looks something like <code>myvideo.us-east-1.linodeobjects.com</code>, the bucket name to match the one you just created and the S3 region to match the <code>us-east-1</code> equivalent of the above hostname.</li><li>Using the <a href=https://cloud.linode.com/object-storage/access-keys>Linode Object Access Keys</a> page create a new Access Key and add the Key and Secret to your <code>config.yaml</code> file.</li></ul><p>In the following steps Linode requires you to interact with your bucket using the s3cmd tool. So install that on your terminal and configure it.</p><p>Run <code>s3cmd --configure</code> and fill in the values with what is currently in your config file. It should look similar to this:<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>Access Key</span>: ABC12334
<span style=color:#66d9ef>Secret Key</span>: fj3kd83jdkh
<span style=color:#66d9ef>Default Region</span>: US
<span style=color:#66d9ef>S3 Endpoint</span>: us-east<span style=color:#ae81ff>-1.</span>linodeobjects.com
<span style=color:#66d9ef>DNS-style bucket+hostname:port template for accessing a bucket</span>: us-east<span style=color:#ae81ff>-1.</span>linodeobjects.com
<span style=color:#66d9ef>Use HTTPS protocol</span>: False</code></pre></div></p><h3 id=add-permissions-to-access-video>Add permissions to access video.
<a class=anchor href=#add-permissions-to-access-video>#</a></h3><p><em>This part sucks</em>. But you only have to do it once per bucket. <a href=https://www.linode.com/docs/platform/object-storage/how-to-use-object-storage-acls-and-bucket-policies/#bucket-policies>These are the full instructions</a> but let me summarize.</p><ol><li><p>Create a file called bucket_policy.json that has the following:<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#f92672>&#34;Statement&#34;</span>: [
    {
      <span style=color:#f92672>&#34;Effect&#34;</span>: <span style=color:#e6db74>&#34;Allow&#34;</span>,
      <span style=color:#f92672>&#34;Principal&#34;</span>: {
        <span style=color:#f92672>&#34;AWS&#34;</span>: [
          <span style=color:#e6db74>&#34;*&#34;</span>
        ]
      },
      <span style=color:#f92672>&#34;Action&#34;</span>: [
        <span style=color:#e6db74>&#34;s3:GetObject&#34;</span>
      ],
      <span style=color:#f92672>&#34;Resource&#34;</span>: [
        <span style=color:#e6db74>&#34;arn:aws:s3::MYBUCKETNAME/*&#34;</span>
      ]
    }
  ]
}</code></pre></div></p></li><li><p>Replace <code>MYBUCKETNAME</code> with your actual bucket name.</p></li><li><p>Run <code>s3cmd setpolicy bucket_policy.json s3://MYBUCKETNAME</code> replacing <code>MYBUCKETNAME</code> with your bucket name.</p></li><li><p>Run <code>s3cmd info s3://MYBUCKETNAME</code> to make sure the new policy saved.</p></li></ol><p>Now files video saved to Linode Object Storage will be readable.</p><p>More details about how to get started using Linode Object Storage can be found <a href=https://www.linode.com/docs/platform/object-storage/how-to-use-object-storage/>on their documentation</a>.</p><h3 id=file-expiration>File expiration
<a class=anchor href=#file-expiration>#</a></h3><p>Make files older than one day expire and delete themselves so you don&rsquo;t pay for storage of old video.</p><p>Full details are in <a href=https://www.linode.com/docs/platform/object-storage/how-to-manage-objects-with-lifecycle-policies/>their documentation</a>.</p><p>Create a file called <code>lifecycle_policy.json</code> with the following contents:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;LifecycleConfiguration&gt;</span>
    <span style=color:#f92672>&lt;Rule&gt;</span>
        <span style=color:#f92672>&lt;ID&gt;</span>delete-all-objects<span style=color:#f92672>&lt;/ID&gt;</span>
        <span style=color:#f92672>&lt;Prefix&gt;&lt;/Prefix&gt;</span>
        <span style=color:#f92672>&lt;Status&gt;</span>Enabled<span style=color:#f92672>&lt;/Status&gt;</span>
        <span style=color:#f92672>&lt;Expiration&gt;</span>
            <span style=color:#f92672>&lt;Days&gt;</span>1<span style=color:#f92672>&lt;/Days&gt;</span>
        <span style=color:#f92672>&lt;/Expiration&gt;</span>
    <span style=color:#f92672>&lt;/Rule&gt;</span>
<span style=color:#f92672>&lt;/LifecycleConfiguration&gt;</span></code></pre></div><ul><li>Run <code>s3cmd setlifecycle lifecycle_policy.xml s3://MYBUCKETNAME</code>.</li><li>Run <code>s3cmd info s3://MYBUCKETNAME</code> and you should now see <code>Expiration Rule: all objects in this bucket will expire in '1' day(s) after creation</code>.</li></ul><h2 id=aws-s3>AWS S3
<a class=anchor href=#aws-s3>#</a></h2><p>AWS S3 is a good choice if you&rsquo;re already using AWS for your server or are comfortable using AWS for other things. If you&rsquo;re brand new to object storage and not using AWS already I&rsquo;m not sure I&rsquo;d recommend jumping into it just for Owncast. There are other options.</p><p>Here&rsquo;s some example usage and pricing for AWS S3:<div style=text-align:center><figure><img src=/docs/img/aws-price-usage.png></figure></div></p><h3 id=file-expiration-1>File expiration
<a class=anchor href=#file-expiration-1>#</a></h3><p>You should expire old segments on your S3 bucket. <a href=https://docs.aws.amazon.com/AmazonS3/latest/user-guide/create-lifecycle.html>Here are some instructions on how to do that.</a></p><ul><li>Once an object expires you won&rsquo;t be charged for storage, even if the object isn&rsquo;t deleted immediately.</li><li>A one day object expiration lifecycle rule on objects is as low as you can go, so use that.</li><li>Because AWS <a href=https://aws.amazon.com/premiumsupport/knowledge-center/s3-lifecycle-rule-delay/>rounds the expiration to midnight of the next day</a> you may have a lot of old video chunks sitting around. You can make the most of this by increasing the <code>maxNumberInPlaylist</code> value in your config file to something much higher, allowing users to rewind your stream back in time further. If the video is available then you might as well make it available to your users.</li></ul><h3 id=cors>CORS
<a class=anchor href=#cors>#</a></h3><ul><li>Ugh. CORS. <a href=https://docs.aws.amazon.com/AmazonS3/latest/dev/cors.html#how-do-i-enable-cors>You will need to enable CORS on your bucket</a> so the web player can access the video.</li></ul><h3 id=cdn>CDN
<a class=anchor href=#cdn>#</a></h3><p>AWS (and other S3 compatible providers) offer a feature to change the HTTP host to support CDNs. You can configure Owncast to serve media files from this host by setting the <code>s3.servingEndpoint</code> config to your CDNed host.</p><h2 id=wasabi-cloud-storage>Wasabi cloud storage
<a class=anchor href=#wasabi-cloud-storage>#</a></h2><p>Most people would end up paying $5.99/mo with <a href=https://wasabi.com/content-delivery/>Wasabi</a>, and there&rsquo;s no additional costs for the amount of people or amount of times people access your video. So if you have a ton of viewers, this is probably a good option.</p><h3 id=create-a-user-and-access-key>Create a user and access key.
<a class=anchor href=#create-a-user-and-access-key>#</a></h3><ol><li><a href="https://wasabi.com/wp-content/themes/wasabi/docs/Getting_Started/index.html#t=topics%2FCreating_a_User.htm">Create a new user on Wasabi</a> for yourself.</li><li><a href="https://wasabi.com/wp-content/themes/wasabi/docs/Getting_Started/index.html#t=topics%2FAssigning_an_Access_Key.htm">Create a new Access Key</a> in the Users Panel.</li><li>Update your Owncast <code>config.json</code> file with the above Access Key and Secret as well as the other required details.</li></ol><p>Depending on the region where your bucket lives look up the service URL <a href=https://wasabi-support.zendesk.com/hc/en-us/articles/360015106031-What-are-the-service-URLs-for-Wasabi-s-different-regions->from this page</a>.</p><ul><li>Endpoint: Is the &ldquo;service URL&rdquo; you looked up above. Likely <code>s3.wasabisys.com</code> or similar.</li><li>Bucket</li></ul><h3 id=making-files-public>Making files public
<a class=anchor href=#making-files-public>#</a></h3><p>Wasabi makes it easy to make a bucket public. <a href="https://wasabi.com/wp-content/themes/wasabi/docs/Getting_Started/index.html#t=topics%2FMaking_Folders_and_or_Files_Public.htm">Full documentation is here</a>, but simply select the folder and choose &ldquo;<em>Make Public</em>&rdquo;.</p><h3 id=expiration-of-old-files-on-wasabi>Expiration of old files on Wasabi
<a class=anchor href=#expiration-of-old-files-on-wasabi>#</a></h3><p><strong>Important note!</strong> Wasabi does <strong>NOT</strong> seem to have a way to set a policy for deleting old files like AWS and Linode does. You may have your own way of cleaning up old files, or some other solution. But it&rsquo;s something to keep in mind in case you really start to build up a lot of old video files.</p><p>If anybody knows how to enable Lifecycle Policies on Wasabi, please <a href=https://github.com/gabek/owncast/issues>file an issue with details</a>.</p><h2 id=digital-ocean-spaces>Digital Ocean Spaces
<a class=anchor href=#digital-ocean-spaces>#</a></h2><p><a href=https://www.digitalocean.com/products/spaces/>Digital Ocean&rsquo;s offering</a> has been tested and works great as well. Details to be written in the future.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/owncast/owncast.github.io/commit/c7ce93db8e7dea49fa7106b71e64382465a10c7f title="Last modified by Gabe Kangas | August 21, 2020" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>August 21, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/owncast/owncast.github.io/edit/master/content//docs/S3.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#linode-object-storagehttpswwwlinodecompricingr588ad4bf08ce8394e8eb11f0a463fde64637af9drow--storage><a href="https://www.linode.com/pricing/?r=588ad4bf08ce8394e8eb11f0a463fde64637af9d/#row--storage">Linode Object Storage</a></a><ul><li><a href=#add-permissions-to-access-video>Add permissions to access video.</a></li><li><a href=#file-expiration>File expiration</a></li></ul></li><li><a href=#aws-s3>AWS S3</a><ul><li><a href=#file-expiration-1>File expiration</a></li><li><a href=#cors>CORS</a></li><li><a href=#cdn>CDN</a></li></ul></li><li><a href=#wasabi-cloud-storage>Wasabi cloud storage</a><ul><li><a href=#create-a-user-and-access-key>Create a user and access key.</a></li><li><a href=#making-files-public>Making files public</a></li><li><a href=#expiration-of-old-files-on-wasabi>Expiration of old files on Wasabi</a></li></ul></li><li><a href=#digital-ocean-spaces>Digital Ocean Spaces</a></li></ul></nav></aside></main></body></html>